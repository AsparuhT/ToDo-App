const taskInput=document.querySelector("#task-input"),addTaskBtn=document.querySelector("#add-task-btn"),taskSectionList=document.querySelector(".tasks-section__list");function createTask(t,e=!1){var a,s;validateInput(t)&&tasksLimit(document.querySelectorAll(".task"))&&((a=document.createElement("li")).classList.add("task"),(s=document.createElement("p")).classList.add("task-text"),s.textContent=t,t=document.createElement("p"),a.appendChild(t),a.appendChild(s),e&&a.classList.add("completed"),(t=document.createElement("button")).classList.add("task-btn","remove-task-btn"),t.textContent="Remove",a.appendChild(t),(s=document.createElement("button")).classList.add("task-btn","edit-task-btn"),s.textContent="Edit",a.appendChild(s),taskSectionList.appendChild(a),saveTasksToTheLocalStorage(),t.addEventListener("click",t=>{t.target.parentNode.remove(),saveTasksToTheLocalStorage()}),s.addEventListener("click",t=>{editTask(t.target.parentNode)}))}function editTask(t){var e=t.querySelector(".task-text"),a=document.createElement("textarea");a.classList.add("edit-textarea"),a.value=e.textContent,e.style.display="none",t.querySelector(".remove-task-btn").style.display="none";t.querySelector(".edit-task-btn").style.display="none";e=document.createElement("button");e.setAttribute("id","save-task-btn"),e.textContent="Save",e.style.background="#198754",t.appendChild(a),t.appendChild(e),t.classList.add("add-45px-padding")}function saveTask(t){var t=t.target.parentNode,e=t.querySelector(".edit-textarea"),a=t.querySelector(".task-text"),s=t.querySelector(".remove-task-btn"),n=t.querySelector("#save-task-btn"),o=t.querySelector(".edit-task-btn");validateInput(e.value)&&(a.textContent=e.value,n.remove(),e.remove(),a.style.display="inline-block",s.style.display="inline-block",o.style.display="inline-block",saveTasksToTheLocalStorage(),t.classList.remove("add-45px-padding"))}function completeTask(t){let e;"LI"==t.target.tagName&&(e=t.target),(e="P"==t.target.tagName?t.target.parentNode:e).classList.toggle("completed")}function saveTasksToTheLocalStorage(){var t=document.querySelectorAll(".task"),t=Array.from(t).map((t,e)=>{var a=t.querySelector(".task-text").textContent,t=t.classList.contains("completed");return localStorage.setItem(`task${e}_completed`,JSON.stringify(t)),a}),t=JSON.stringify(t);localStorage.setItem("tasks",t)}function loadDataFromTheLocalStorage(){localStorage.getItem("tasks")&&JSON.parse(localStorage.getItem("tasks")).forEach((t,e)=>{createTask(t,JSON.parse(localStorage.getItem(`task${e}_completed`)))})}function validateInput(t){var e,t=t.trim();return t.length<1?(alert("The task title should contain at lest 1 character. "),!1):500<t.length?(e=t.length,alert(`The task title can be up to of 500 charcters. At the moment the task title is ${e} characters long. `),!1):t}function tasksLimit(t){return!(31<t.length&&(alert("No more then 31 tasks can be created at a time . "),1))}addTaskBtn.addEventListener("click",()=>{createTask(taskInput.value),taskInput.value="",taskInput.focus()}),taskInput.addEventListener("keypress",t=>{"Enter"===t.key&&(createTask(taskInput.value),taskInput.value="")}),taskSectionList.addEventListener("click",t=>{"save-task-btn"===t.target.id&&saveTask(t)}),taskSectionList.addEventListener("click",t=>{(t.target.classList.contains("task")||t.target.classList.contains("task-text"))&&(completeTask(t),saveTasksToTheLocalStorage())}),document.addEventListener("DOMContentLoaded",()=>{loadDataFromTheLocalStorage(),taskInput.value=""}),taskInput.focus();